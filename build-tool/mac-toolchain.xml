<xml>
<!-- MACOS TOOLS -------------------------------------------------->

<include name="gcc-toolchain.xml"/>
<setenv name="MACOSX_DEPLOYMENT_TARGET" value="10.7" if="OBJC_ARC" unless="MACOSX_DEPLOYMENT_TARGET" />
<setenv name="MACOSX_DEPLOYMENT_TARGET" value="10.5" unless="MACOSX_DEPLOYMENT_TARGET" />
<path name="${DEVELOPER_DIR}/usr/bin" />


<compiler id="darwin" exe="g++" if="macos">
  <exe name="xcrun --sdk macosx${MACOSX_VER} clang" if="HXCPP_CLANG" />
  <flag value="-c"/>
  <flag value="-fvisibility=hidden"/>
  <cppflag value="-frtti"/>
  <pchflag value="-x" if="HXCPP_CLANG" />
  <pchflag value="c++-header" if="HXCPP_CLANG" />
  <flag value="-Qunused-arguments" if="LEGACY_MACOSX_SDK" />
  <flag value="-g" if="debug"/>
  <flag value="-O2" unless="debug"/>
  <flag value="-I${HXCPP}/include"/>
  <flag value="-DHX_MACOS"/>
  <flag value="-m32" unless="HXCPP_M64"/>
  <flag value="-m64" if="HXCPP_M64"/>
  <flag value="-DHX_LITTLE_ENDIAN=0" if="HXCPP_BIG_ENDIAN"/>
  <flag value="-DHXCPP_CLANG" if="HXCPP_CLANG" />
  <flag value="-Wno-parentheses" if="HXCPP_CLANG" />
  <flag value="-Wno-null-dereference" if="HXCPP_CLANG" />
  <flag value="-Wno-unused-value" if="HXCPP_CLANG" />
  <flag value="-Wno-format-extra-args" if="HXCPP_CLANG" />
  <flag value="-fobjc-arc" if="OBJC_ARC" />
  <flag value="-DOBJC_ARC" if="OBJC_ARC" />
  <include name="common-defines.xml" />
  <objdir value="obj/darwin${OBJEXT}/" />
  <outflag value="-o"/>
  <ext value=".o"/>
</compiler>

<linker id="dll" exe="g++" if="macos">
  <exe name="xcrun --sdk macosx${MACOSX_VER} clang++" if="HXCPP_CLANG" />
  <fromfile value="" if="GCC_OLD" />
  <flag value="-fobjc-arc" if="OBJC_ARC" />
  <flag value="-Wl,-bundle,-bundle_loader,${dll_import_link}" if="dll_import_link" />
  <flag value="-fpic"/>
  <flag value="-fPIC"/>
  <flag value="-dynamiclib"/>
  <flag value="-m32" unless="HXCPP_M64"/>
  <flag value="-m64" if="HXCPP_M64"/>
  <flag value="-framework"/>
  <flag value="Cocoa"/>
  <flag value="-isysroot" unless="LEGACY_MACOSX_SDK"/>
  <flag value="${DEVELOPER_DIR}/Platforms/MacOSX.platform/Developer/SDKs/MacOSX${MACOSX_VER}.sdk" unless="LEGACY_MACOSX_SDK"/>
  <flag value="-fvisibility=hidden"/>
  <!-- <flag value="-debug" if="debug"/> -->
  <ext value=".dylib"/>
  <outflag value="-o "/>
</linker>

<linker id="exe" exe="g++" if="macos">
  <exe name="xcrun --sdk macosx${MACOSX_VER} clang++" if="HXCPP_CLANG" />
  <!-- <flag value="-Wl,-stack_size,0x8000"/> -->
  <fromfile value="" if="GCC_OLD" />
  <flag value="-fobjc-arc" if="OBJC_ARC" />
  <flag value="-framework"/>
  <flag value="Cocoa"/>
  <flag value="-isysroot" unless="LEGACY_MACOSX_SDK"/>
  <flag value="${DEVELOPER_DIR}/Platforms/MacOSX.platform/Developer/SDKs/MacOSX${MACOSX_VER}.sdk" unless="LEGACY_MACOSX_SDK"/>
  <!-- <flag value="-debug" if="debug"/> -->
  <flag value="-m32" unless="HXCPP_M64"/>
  <flag value="-m64" if="HXCPP_M64"/>
  <ext value=""/>
  <outflag value="-o "/>
</linker>

</xml>
